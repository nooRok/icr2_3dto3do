# icr2_3dto3do

## Installation

```
pip install icr2_3dto3do-x.x.x-py3-none-any.whl
```

## Usage


* for object .3d file: `3d23do.py input.3d root output.3do`
* for track .3d file: `3d23do.py input.3d root output.3do --hash hash`

Values of option "root" and "hash" depend on data definitions in input 3d file.
    
## Options

The script 3d23do.py requires 3 arguments: `input`, `root` and `output`.
* *required* `input`:  input .3d file path.
* *required* `root`: the root definition name of object (in .3d file generated by trk23d, the name is defined "index").
* `output`: output .3do file path.
* `--hash name`: To build icr2 track requires this option (in .3d file generated by trk23d, the name is defined "hash").
* `--scale n`: Value n for to scale output object. the value must be integer (default: 1).
* `--no-opt`: Skip 3do optimization process (see below section). Reducing conversion time in exchange for increasing file size.
* `--silent`: Disable console output.

## 3do optimization

This is a function of [icr2model](https://github.com/nooRok/icr2model).

In optimization process, flavors they have same values are unified to single flavor and 
re-allocate pointers to unified one. It works like:

from
```
0 F00
4 F11 1 0
16 F11 1 0 <- the value is same as 4
28 F11 1 0 <- the value is same as 4
40 F11 3 4 16 28
```
to
```
0 F00
4 F11 1 0 <- remove 16 and 28
28 F11 3 4 4 4 <- re-allocate pointers
```
finally
```
0 F00
4 F11 1 0
16 F11 3 4 4 4
```

and for vertex:

from
```
0 V02 42500 -13750 -13750 22 73
20 V02 41250 -13750 -11250 22 65
40 V02 31875 -16875 -11250 3 65
60 V02 31875 -16625 -13750 8 73
80 V02 31875 -16625 -13750 8 73 <- the value is same as 60
100 V01 21250 16875 -7500
116 V01 21250 -16875 -7500
132 V01 31875 -16875 -11250 <- the coodinate is same as 40
148 V01 31875 -16875 -13750 <- the coodinate is same as 60
164 F02 16 35 3 0 20 40 60
192 F02 16 35 2 0 20 80
220 F01 35 3 100 116 132 148
```
to
```
0 V02 42500 -13750 -13750 22 73
20 V02 41250 -13750 -11250 22 65
40 V02 31875 -16875 -11250 3 65
60 V02 31875 -16625 -13750 8 73 <- remove 80
100 V01 21250 16875 -7500
116 V01 21250 -16875 -7500 <- remove 132 and 148
164 F02 16 35 3 0 20 40 60
192 F02 16 35 2 0 20 60 <- re-allocate pointers
220 F01 35 3 100 116 40 60 <- re-allocate pointers
```
finally
```
0 V02 42500 -13750 -13750 22 73
20 V02 41250 -13750 -11250 22 65
40 V02 31875 -16875 -11250 3 65
60 V02 31875 -16625 -13750 8 73
80 V01 21250 16875 -7500
96 V01 21250 -16875 -7500
112 F02 16 35 3 0 20 40 60
140 F02 16 35 2 0 20 60
164 F01 35 3 80 96 40 60
```

The value of texture position of V02 is ignored if it is called from F01 (it works as V01). 